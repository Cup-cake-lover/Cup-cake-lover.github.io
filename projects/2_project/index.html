<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Neural synchrony. | Hari prasad SV </title> <meta name="author" content="Hari prasad SV"> <meta name="description" content="Simulating synchrony in brain --&gt; The hard way!"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A7%81&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://cup-cake-lover.github.io/projects/2_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Hari</span> prasad SV </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About me </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/talks/">Talks </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Git </a> </li> <li class="nav-item "> <a class="nav-link" href="/resume/">Resume </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Neural synchrony.</h1> <p class="post-description">Simulating synchrony in brain --&gt; The hard way!</p> </header> <article> <hr> <div class="links text-center d-flex justify-content-center"> <a href="https://github.com/Cup-cake-lover/Neural-Synchrony.git" class="mx-2" style="color: #333;" rel="external nofollow noopener" target="_blank"> <i class="fab fa-github fa-lg"></i> Code </a> <a href="/assets/pdf/slides/neuralsyncslides.pdf" class="mx-2" style="color: #d9534f;"> <i class="fa fa-file-pdf fa-lg"></i> Slides </a> </div> <hr> <p>Synchronization is a remarkable emergent phenomenon observed in many natural systems, where independent components begin to exhibit collective behavior. This phenomenon can be found in biological, physical, and even social systems. For instance, fireflies synchronize their flashing, neurons in the brain fire together in rhythmic patterns, and even coupled pendulums tend to swing in unison over time. These systems, often described by nonlinear dynamics, display synchronization when individual elements interact with each other, leading to a collective coherence despite differences in initial conditions or external influences.</p> <p>From the title, it should be clear to the reader that this article will detail an aspect of synchrony in the brain. Although it may be surprising to those new to the topic, synchrony is well-researched in the context of brain dynamics. In this article, I will outline how such a system can be studied through simulations.</p> <h2 id="synchronisation-in-dynamical-systems">Synchronisation in dynamical systems</h2> <p>What is synchronisation? In the introduction, I briefly mentioned that it is an emergent phenomenon that appears in coupled dynamical systems. I won’t be delving into a rigorous mathematical description of synchronisation in coupled systems. However, I will briefly explain it through some simulations I prepared using the open-source Python package <a href="https://www.manim.community/" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">manim</code></a>.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <iframe width="100%" height="315" src="https://www.youtube.com/embed/ZGvtnE1Wy6U" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""> </iframe> </div> <div class="col-sm mt-3 mt-md-0"> <iframe width="100%" height="315" src="https://www.youtube.com/embed/T58lGKREubo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""> </iframe> </div> </div> <div class="caption"> Common examples of synchronisation; Left shows synchrony of blinking patterns of fireflies. Right is the classic clicking metronomes. </div> <h3 id="the-kuramoto-model">The Kuramoto model</h3> <p>Here, we consider a relatively simple model of synchrony: the Kuramoto model. The Kuramoto model describes a set of phase oscillators coupled through a sinusoidal function. The dynamics of the system of oscillators can then be described by the following differential equation.</p> \[\dot \theta_i = \omega_i + \frac{k}{N} \sum_{j=1}^N \sin(\theta_j - \theta_i), ~~~i=1,\ldots, N\] <p>Here \(\theta_i\) represents phase of the \(i^{th}\) oscillator. The coupling strength between these oscillators are described by the coupling constant \(k\). The value of \(k\) is crucial in the synchronisation behaviour of the system. So this describes our model, how do we charecterize synchrony? One way is to define an order parameter \(R\). It is defined as follows,</p> \[R\equiv re^{i\psi} = \frac{1}{N}\sum_{j=1}^N e^{i \theta_j}.\] <p>Order parameters are usually a statistical physicist’s ‘favorite’ quantity to compute when the collective behavior of a system undergoes rapid change. In the animations shown below, both the \(K\) value and the corresponding \(R\) value are displayed. Notice that for very low coupling, the order parameter never increases. However, when we set \(K&gt;0\), we observe that the order parameter rises drastically, indicating that the system is achieving synchrony.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/neural_sync/KuramotoOscillatorsk_0.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" autoplay="" controls=""></video> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <video src="/assets/video/neural_sync/KuramotoOscillatorss0.7.mp4" class="img-fluid rounded z-depth-1" width="auto" height="auto" autoplay="" controls=""></video> </figure> </div> </div> <div class="caption"> Manim animations of a system of Kuramoto oscillators. The animation on the left represents the system with coupling value set to zero, on the right, the coupling value is non zero, resulting in the synchrony of oscillators. </div> <h2 id="synchrony-in-the-brain">Synchrony in the brain</h2> <p>Our brain is composed of millions of neurons, synapses, and associated cells. Together, they form an incredible computing unit that performs complex computations of the real world. With its help, we receive, process, and communicate information. What fascinates me even more is the sheer complexity of the brain. Not only does it maintain high-level processes such as thoughts and memory, but it is also an integral part of low-level, involuntary operations that happen every second in our body. Researchers have been studying the brain as a complex collective dynamical system to understand how individual computing units composed of neurons and synapses work together.</p> <p>Now, after all the foreshadowing from the previous section, we finally reach the point where I will discuss neural synchrony. The brain is composed of inhibitory and excitatory neurons. As their names suggest, inhibitory neurons inhibit the actions of excitatory neurons. We consider networks of such neurons with varying percentage-wise compositions. The network connections are generally defined probabilistically, meaning we set a probability value for connections between excitatory-excitatory (\(p_{ee}\)), inhibitory-inhibitory (\(p_{ii}\)), inhibitory-excitatory (\(p_{ie}\)) and excitatory-inhibitory (\(p_{ei}\)) connections.</p> <p>Computationally modeling such systems has become relatively simpler in recent years. Dedicated neural dynamics packages like <a href="https://www.nest-simulator.org/" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">NEST</code></a> or <a href="https://brian2.readthedocs.io/en/stable/" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">Brian2</code></a> exist for advanced large-scale simulations. It is possible to generate the results I am going to show in this article using such packages. However, I want to take a more ‘coded from scratch’ approach. While this is a challenging task, I believe it provides much more conceptual insight.</p> <p>To begin, we need a neuron model to describe how a single neuron operates in our system. I will follow the approach by <a href="https://doi.org/10.3389/fncom.2021.663408" rel="external nofollow noopener" target="_blank">Protachevicz et al. 2021</a> from their paper on the ‘Emergence of Neuronal Synchronisation in Coupled Areas’. In this paper, they study the coupling dynamics of two different brain regions composed of two distinct networks. Here, we consider a piece of the cortex network, which is largely composed of pyramidal excitatory neurons and inhibitory interneurons. The excitatory neurons exhibit an adaptive spiking mechanism, while inhibitory neurons do not. This behavior can be modeled by the Adaptive Exponential Leaky Integrate-and-Fire (AdEx-LIF) neuron model. Mathematically, the model can be written as follows:</p> \[C_m \frac{dV_j}{dt} = g_L (V_j - E_L) + g_L \Delta T \exp\left(\frac{V_j - V_T}{\Delta T}\right) - w_j + I + I_{j}\] \[\tau_w \frac{dw_j}{dt} = a_j (V_j - E_L) - w_j\] \[\tau_s \frac{dg_j}{dt} = -g_j\] <p>And the spiking dynamics is achieved by the following update dynamics,</p> \[V_j \rightarrow V_r\] \[w_j \rightarrow w_j + b_j \\\] \[g_j \rightarrow g_j + g_s\] <p>Here, the membrane potential of a neuron is denoted as \(V_j\), where \(C_m\) is the membrane capacitance, \(g_L\) represents the leak conductance, and \(E_L\) is the leak reversal potential. The exponential term involves the slope factor \(\Delta T\) and the spike threshold potential \(V_T\). The adaptation current for each neuron is \(w_j\), and the parameters governing the adaptation mechanism are the subthreshold adaptation \(a_j\), the triggered adaptation \(b_j\), and the adaptation time constant \(\tau_w\). The injected current into the neuron is \(I\), and the synaptic input is represented by the synaptic conductance \(g_{jk}\) and the synaptic time constant \(\tau_s\). The chemical input current is \(I_{\text{chem}}\), and the synaptic reversal potential is \(V_{\text{REV}}\). Synaptic conductances for connections between excitatory and inhibitory neurons are denoted as \(g_{ee}\), \(g_{ei}\), \(g_{ie}\), and \(g_{ii}\).</p> <p>Now that we have a model, we can set this up in code. To do this, different paramter values needs to adapted. I am going to take the values mentioned in the paper as a stardarnd a write a dictionary in Python as following. As we are coding everythign from ‘scratch’, we are going to only use <code class="language-plaintext highlighter-rouge">numpy</code> for mathematical operations and <code class="language-plaintext highlighter-rouge">matplotlib</code> for plotting.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span></code></pre></figure> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">initialize_parameters</span><span class="p">():</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">Cm</span><span class="sh">"</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span>        <span class="c1"># Capacitance membrane (pF)
</span>        <span class="sh">"</span><span class="s">gL</span><span class="sh">"</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>         <span class="c1"># Leak conductance (nS)
</span>        <span class="sh">"</span><span class="s">EL</span><span class="sh">"</span><span class="p">:</span> <span class="o">-</span><span class="mi">70</span><span class="p">,</span>        <span class="c1"># Leak reversal potential (mV)
</span>        <span class="sh">"</span><span class="s">Delta_T</span><span class="sh">"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>     <span class="c1"># Slope factor (mV)
</span>        <span class="sh">"</span><span class="s">d_exc</span><span class="sh">"</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>     <span class="c1"># Excitatory conductance time delay (ms)
</span>        <span class="sh">"</span><span class="s">d_inh</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>     <span class="c1"># Inhibitory conductance time delay (ms)
</span>        <span class="sh">"</span><span class="s">VT</span><span class="sh">"</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span>        <span class="c1"># Spike threshold (mV)
</span>        <span class="sh">"</span><span class="s">I</span><span class="sh">"</span><span class="p">:</span> <span class="mi">270</span><span class="p">,</span>         <span class="c1"># Injection current (pA)
</span>        <span class="sh">"</span><span class="s">aj_exc</span><span class="sh">"</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mf">1.9</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span>  <span class="c1"># Subthreshold adaptation for excitatory neurons (nS)
</span>        <span class="sh">"</span><span class="s">bj_exc</span><span class="sh">"</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>     <span class="c1"># Spike-triggered adaptation for excitatory neurons (pA)
</span>        <span class="sh">"</span><span class="s">aj_inh</span><span class="sh">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>      <span class="c1"># Subthreshold adaptation for inhibitory neurons (nS)
</span>        <span class="sh">"</span><span class="s">bj_inh</span><span class="sh">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>      <span class="c1"># Spike-triggered adaptation for inhibitory neurons (pA)
</span>        <span class="sh">"</span><span class="s">tau_w</span><span class="sh">"</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>     <span class="c1"># Adaptation time constant (ms)
</span>        <span class="sh">"</span><span class="s">tau_s</span><span class="sh">"</span><span class="p">:</span> <span class="mf">2.728</span><span class="p">,</span>   <span class="c1"># Synaptic time constant (ms)
</span>        <span class="sh">"</span><span class="s">Vr</span><span class="sh">"</span><span class="p">:</span> <span class="o">-</span><span class="mi">58</span><span class="p">,</span>        <span class="c1"># Reset potential (mV)
</span>        <span class="sh">"</span><span class="s">Vthres</span><span class="sh">"</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span>    <span class="c1"># Threshold potential (mV)
</span>        <span class="sh">"</span><span class="s">Vexc_REV</span><span class="sh">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>    <span class="c1"># Excitatory reversal potential (mV)
</span>        <span class="sh">"</span><span class="s">Vinh_REV</span><span class="sh">"</span><span class="p">:</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span>  <span class="c1"># Inhibitory reversal potential (mV)
</span>        <span class="sh">"</span><span class="s">gee</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>        <span class="c1"># Synaptic conductance for excitatory to excitatory (nS)
</span>        <span class="sh">"</span><span class="s">gei</span><span class="sh">"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>       <span class="c1"># Synaptic conductance for excitatory to inhibitory (nS)
</span>        <span class="sh">"</span><span class="s">gie</span><span class="sh">"</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>        <span class="c1"># Synaptic conductance for inhibitory to excitatory (nS)
</span>        <span class="sh">"</span><span class="s">gii</span><span class="sh">"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>        <span class="c1"># Synaptic conductance for inhibitory to inhibitory (nS)
</span>        <span class="sh">"</span><span class="s">dt</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>        <span class="c1"># Time step (ms)
</span>        <span class="sh">"</span><span class="s">T</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>        <span class="c1"># Total simulation time (ms)
</span>        <span class="sh">"</span><span class="s">N</span><span class="sh">"</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>        <span class="c1"># Number of neurons
</span>        <span class="sh">"</span><span class="s">Pexc</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>      <span class="c1"># Proportion of excitatory neurons
</span>        <span class="sh">"</span><span class="s">Pinh</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>      <span class="c1"># Proportion of inhibitory neurons
</span>        <span class="sh">"</span><span class="s">connection_prob</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">pee</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># Excitatory to excitatory within area
</span>            <span class="sh">"</span><span class="s">pii</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>   <span class="c1"># Inhibitory to inhibitory within area
</span>            <span class="sh">"</span><span class="s">pei</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># Excitatory to inhibitory within area
</span>            <span class="sh">"</span><span class="s">pie</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># Inhibitory to excitatory within area
</span>        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">params</span></code></pre></figure> <p>After the parameters are set we need to define a network in which the nodes are going to place the neurons we created. First we create a population of inhibitory and excitatory neurons:</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">initialize_neurons</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">N</span><span class="p">,</span> <span class="n">P_exc</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">N</span><span class="sh">'</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">Pexc</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">N_exc</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">N</span> <span class="o">*</span> <span class="n">P_exc</span><span class="p">)</span>  <span class="c1"># Number of excitatory neurons
</span>    <span class="n">N_inh</span> <span class="o">=</span> <span class="n">N</span> <span class="o">-</span> <span class="n">N_exc</span>       <span class="c1"># Number of inhibitory neurons
</span>    
    <span class="c1"># Create an array with the first N_exc elements as 1 (excitatory) and the rest as -1 (inhibitory)
</span>    <span class="n">neuron_types</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">N_exc</span> <span class="o">+</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">N_inh</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">neuron_types</span></code></pre></figure> <p>Now we describe dynamics of the neurons, to do this we first create functions that represents the differential equations of the adEx-LIF model as follows,</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">dVdt</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">I_chem</span><span class="p">):</span>
    <span class="nf">return </span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">gL</span><span class="sh">'</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">EL</span><span class="sh">'</span><span class="p">]</span> <span class="o">-</span> <span class="n">V</span><span class="p">)</span> <span class="o">+</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">gL</span><span class="sh">'</span><span class="p">]</span> <span class="o">*</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">Delta_T</span><span class="sh">'</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">((</span><span class="n">V</span> <span class="o">-</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">Vthres</span><span class="sh">'</span><span class="p">])</span> <span class="o">/</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">Delta_T</span><span class="sh">'</span><span class="p">])</span> <span class="o">-</span> <span class="n">w</span> <span class="o">+</span> <span class="n">I_chem</span> <span class="o">+</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">I</span><span class="sh">'</span><span class="p">])</span> <span class="o">/</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">Cm</span><span class="sh">'</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">dwdt</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">neuron_types</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">neuron_types</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">aj_exc</span><span class="sh">'</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
    <span class="nf">return </span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="n">V</span> <span class="o">-</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">EL</span><span class="sh">'</span><span class="p">])</span> <span class="o">-</span> <span class="n">w</span><span class="p">)</span> <span class="o">/</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">tau_w</span><span class="sh">'</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">dg_syn_dt</span><span class="p">(</span><span class="n">g_syn</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">g_syn</span> <span class="o">/</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">tau_s</span><span class="sh">'</span><span class="p">]</span></code></pre></figure> <p>To solve them iteratively, we use a numerical integration scheme, here we use a 4th order Runge Kutta method. Which is coded as follows,</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">rk4_step</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">g_syn_exc</span><span class="p">,</span> <span class="n">g_syn_inh</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">I_chem</span><span class="p">,</span> <span class="n">neuron_types</span><span class="p">):</span>
    <span class="n">k1_V</span> <span class="o">=</span> <span class="nf">dVdt</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">I_chem</span><span class="p">)</span>
    <span class="n">k1_w</span> <span class="o">=</span> <span class="nf">dwdt</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">neuron_types</span><span class="p">)</span>
    <span class="n">k1_g_syn_exc</span> <span class="o">=</span> <span class="nf">dg_syn_dt</span><span class="p">(</span><span class="n">g_syn_exc</span><span class="p">)</span>
    <span class="n">k1_g_syn_inh</span> <span class="o">=</span> <span class="nf">dg_syn_dt</span><span class="p">(</span><span class="n">g_syn_inh</span><span class="p">)</span>
    
    <span class="n">k2_V</span> <span class="o">=</span> <span class="nf">dVdt</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k1_V</span><span class="p">,</span> <span class="n">w</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k1_w</span><span class="p">,</span> <span class="n">I_chem</span><span class="p">)</span>
    <span class="n">k2_w</span> <span class="o">=</span> <span class="nf">dwdt</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k1_V</span><span class="p">,</span> <span class="n">w</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k1_w</span><span class="p">,</span> <span class="n">neuron_types</span><span class="p">)</span>
    <span class="n">k2_g_syn_exc</span> <span class="o">=</span> <span class="nf">dg_syn_dt</span><span class="p">(</span><span class="n">g_syn_exc</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k1_g_syn_exc</span><span class="p">)</span>
    <span class="n">k2_g_syn_inh</span> <span class="o">=</span> <span class="nf">dg_syn_dt</span><span class="p">(</span><span class="n">g_syn_inh</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k1_g_syn_inh</span><span class="p">)</span>
    
    <span class="n">k3_V</span> <span class="o">=</span> <span class="nf">dVdt</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k2_V</span><span class="p">,</span> <span class="n">w</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k2_w</span><span class="p">,</span> <span class="n">I_chem</span><span class="p">)</span>
    <span class="n">k3_w</span> <span class="o">=</span> <span class="nf">dwdt</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k2_V</span><span class="p">,</span> <span class="n">w</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k2_w</span><span class="p">,</span> <span class="n">neuron_types</span><span class="p">)</span>
    <span class="n">k3_g_syn_exc</span> <span class="o">=</span> <span class="nf">dg_syn_dt</span><span class="p">(</span><span class="n">g_syn_exc</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k2_g_syn_exc</span><span class="p">)</span>
    <span class="n">k3_g_syn_inh</span> <span class="o">=</span> <span class="nf">dg_syn_dt</span><span class="p">(</span><span class="n">g_syn_inh</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k2_g_syn_inh</span><span class="p">)</span>
    
    <span class="n">k4_V</span> <span class="o">=</span> <span class="nf">dVdt</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k3_V</span><span class="p">,</span> <span class="n">w</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k3_w</span><span class="p">,</span> <span class="n">I_chem</span><span class="p">)</span>
    <span class="n">k4_w</span> <span class="o">=</span> <span class="nf">dwdt</span><span class="p">(</span><span class="n">V</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k3_V</span><span class="p">,</span> <span class="n">w</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k3_w</span><span class="p">,</span> <span class="n">neuron_types</span><span class="p">)</span>
    <span class="n">k4_g_syn_exc</span> <span class="o">=</span> <span class="nf">dg_syn_dt</span><span class="p">(</span><span class="n">g_syn_exc</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k3_g_syn_exc</span><span class="p">)</span>
    <span class="n">k4_g_syn_inh</span> <span class="o">=</span> <span class="nf">dg_syn_dt</span><span class="p">(</span><span class="n">g_syn_inh</span> <span class="o">+</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">k3_g_syn_inh</span><span class="p">)</span>
    
    <span class="n">V_new</span> <span class="o">=</span> <span class="n">V</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1_V</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">k2_V</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">k3_V</span> <span class="o">+</span> <span class="n">k4_V</span><span class="p">)</span>
    <span class="n">w_new</span> <span class="o">=</span> <span class="n">w</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1_w</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">k2_w</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">k3_w</span> <span class="o">+</span> <span class="n">k4_w</span><span class="p">)</span>
    <span class="n">g_syn_exc_new</span> <span class="o">=</span> <span class="n">g_syn_exc</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1_g_syn_exc</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">k2_g_syn_exc</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">k3_g_syn_exc</span> <span class="o">+</span> <span class="n">k4_g_syn_exc</span><span class="p">)</span>
    <span class="n">g_syn_inh_new</span> <span class="o">=</span> <span class="n">g_syn_inh</span> <span class="o">+</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">k1_g_syn_inh</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">k2_g_syn_inh</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">k3_g_syn_inh</span> <span class="o">+</span> <span class="n">k4_g_syn_inh</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">V_new</span><span class="p">,</span> <span class="n">w_new</span><span class="p">,</span> <span class="n">g_syn_exc_new</span><span class="p">,</span> <span class="n">g_syn_inh_new</span></code></pre></figure> <p>The model is set now, we move onto creating a network with specific connection probabilities.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">make_network</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">neurons</span> <span class="o">=</span> <span class="nf">initialize_neurons</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">N</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">connectivity_within</span> <span class="o">=</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">pee</span><span class="sh">"</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="sh">"</span><span class="s">connection_prob</span><span class="sh">"</span><span class="p">][</span><span class="sh">"</span><span class="s">pee</span><span class="sh">"</span><span class="p">],</span>
        <span class="sh">"</span><span class="s">pii</span><span class="sh">"</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="sh">"</span><span class="s">connection_prob</span><span class="sh">"</span><span class="p">][</span><span class="sh">"</span><span class="s">pii</span><span class="sh">"</span><span class="p">],</span>
        <span class="sh">"</span><span class="s">pei</span><span class="sh">"</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="sh">"</span><span class="s">connection_prob</span><span class="sh">"</span><span class="p">][</span><span class="sh">"</span><span class="s">pei</span><span class="sh">"</span><span class="p">],</span>
        <span class="sh">"</span><span class="s">pie</span><span class="sh">"</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">rand</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">params</span><span class="p">[</span><span class="sh">"</span><span class="s">connection_prob</span><span class="sh">"</span><span class="p">][</span><span class="sh">"</span><span class="s">pie</span><span class="sh">"</span><span class="p">]</span>
    <span class="p">}</span>
  
    <span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">g_exc</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">g_inh</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">V</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">EL</span><span class="sh">'</span><span class="p">],</span><span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">VT</span><span class="sh">'</span><span class="p">])</span>
        
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="k">if</span> <span class="n">neurons</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span>
                
    <span class="k">return</span> <span class="n">connectivity_within</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">g_exc</span><span class="p">,</span><span class="n">g_inh</span></code></pre></figure> <p>Finally to tie everything up, we create a <code class="language-plaintext highlighter-rouge">simulate</code> function. Note that the dynamic differs for both inhibitory and excitatory neurons. This is taken care of by simply considering the label of the neuron we defined earlier. We set the total simulation time to be 3000 ms for a total of 100 neurons. The integration time step is set to be 0.02 ms.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">simulate</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">connectivity_within</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">g_exc</span><span class="p">,</span><span class="n">g_inh</span> <span class="o">=</span> <span class="nf">make_network</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mf">0.02</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mi">3000</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">N</span><span class="sh">'</span><span class="p">])</span>
    <span class="n">neurons</span> <span class="o">=</span> <span class="nf">initialize_neurons</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="n">simulation_time</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">T</span><span class="o">/</span><span class="n">dt</span><span class="p">)</span>
    <span class="n">V_trace</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">simulation_time</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
    <span class="n">spikes</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">simulation_time</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">simulation_time</span><span class="p">):</span>
        <span class="n">spike_time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="c1">#Spike when crosses threshold
</span>            <span class="k">if</span> <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">Vthres</span><span class="sh">'</span><span class="p">]:</span>
                <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">Vr</span><span class="sh">'</span><span class="p">]</span>
                <span class="n">w</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">bj_exc</span><span class="sh">'</span><span class="p">]</span> <span class="k">if</span> <span class="n">neurons</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span> <span class="k">else</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">bj_inh</span><span class="sh">'</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">neurons</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">g_exc</span> <span class="o">+=</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">gee</span><span class="sh">'</span><span class="p">]</span><span class="o">*</span><span class="n">connectivity_within</span><span class="p">[</span><span class="sh">'</span><span class="s">pee</span><span class="sh">'</span><span class="p">][</span><span class="n">j</span><span class="p">,:]</span><span class="o">*</span><span class="n">connectivity_within</span><span class="p">[</span><span class="sh">'</span><span class="s">pei</span><span class="sh">'</span><span class="p">][</span><span class="n">j</span><span class="p">,:]</span>
                <span class="k">if</span> <span class="n">neurons</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">g_inh</span> <span class="o">+=</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">gii</span><span class="sh">'</span><span class="p">]</span><span class="o">*</span><span class="n">connectivity_within</span><span class="p">[</span><span class="sh">'</span><span class="s">pii</span><span class="sh">'</span><span class="p">][</span><span class="n">j</span><span class="p">,:]</span><span class="o">*</span><span class="n">connectivity_within</span><span class="p">[</span><span class="sh">'</span><span class="s">pie</span><span class="sh">'</span><span class="p">][</span><span class="n">j</span><span class="p">,:]</span>
                
                <span class="n">spike_time</span> <span class="o">+=</span> <span class="n">t</span><span class="o">*</span><span class="mf">0.02</span>
                <span class="n">spikes</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">Isyn_exc</span> <span class="o">=</span> <span class="n">g_exc</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">Vexc_REV</span><span class="sh">'</span><span class="p">]</span> <span class="o">-</span> <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">spike_time</span> <span class="o">-</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">d_exc</span><span class="sh">'</span><span class="p">])</span>
            <span class="n">Isyn_inh</span> <span class="o">=</span> <span class="n">g_inh</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">Vinh_REV</span><span class="sh">'</span><span class="p">]</span> <span class="o">-</span> <span class="n">V</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">spike_time</span> <span class="o">-</span> <span class="n">params</span><span class="p">[</span><span class="sh">'</span><span class="s">d_inh</span><span class="sh">'</span><span class="p">])</span>
            
            <span class="n">I_chem</span> <span class="o">=</span> <span class="n">Isyn_exc</span> <span class="o">+</span> <span class="n">Isyn_inh</span>
            
        <span class="n">V</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">g_exc</span><span class="p">,</span> <span class="n">g_inh</span> <span class="o">=</span> <span class="nf">rk4_step</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">g_exc</span><span class="p">,</span> <span class="n">g_inh</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">I_chem</span><span class="p">,</span><span class="n">neurons</span><span class="p">)</span>
        <span class="n">V_trace</span><span class="p">[</span><span class="n">t</span><span class="p">,:]</span> <span class="o">+=</span> <span class="n">V</span>
    <span class="k">return</span> <span class="n">V_trace</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">spikes</span></code></pre></figure> <p>We plot the results uing matplotlib.</p> <figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">dt</span> <span class="o">=</span> <span class="mf">0.02</span>  <span class="c1"># Time step in ms
</span><span class="n">T</span> <span class="o">=</span> <span class="mi">3000</span>   <span class="c1"># Total time in ms
</span><span class="n">spike_times</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">spikes</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">neuron_indices</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">spikes</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">spike_times_real</span> <span class="o">=</span> <span class="n">spike_times</span> <span class="o">*</span> <span class="n">dt</span>
<span class="n">inh_neurons</span> <span class="o">=</span> <span class="n">neuron_indices</span> <span class="o">&gt;=</span> <span class="mi">80</span>  <span class="c1"># Boolean mask for inhibitory neurons
</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">spike_times_real</span><span class="p">[</span><span class="n">inh_neurons</span><span class="p">],</span> <span class="n">neuron_indices</span><span class="p">[</span><span class="n">inh_neurons</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">.</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Inhibitory Neurons</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="n">spike_times_real</span><span class="p">[</span><span class="o">~</span><span class="n">inh_neurons</span><span class="p">],</span> <span class="n">neuron_indices</span><span class="p">[</span><span class="o">~</span><span class="n">inh_neurons</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">.</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Excitatory Neurons</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Time (ms)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Neuron Index</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xticks</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="sh">'</span><span class="s">upper left</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>  <span class="c1"># Adjust layout to make room for the legend
</span><span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="sh">'</span><span class="s">neuralsync.png</span><span class="sh">'</span><span class="p">,</span><span class="n">dpi</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span></code></pre></figure> <p>For certain values of conductances \(g_{ee},g_{ii},g_{ie},g_{ei}\). The spike patterns synchronize, as shown below.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/Neural_sync/neuralsync-480.webp 480w,/assets/img/Neural_sync/neuralsync-800.webp 800w,/assets/img/Neural_sync/neuralsync-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/Neural_sync/neuralsync.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Synchronisation" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Neuronal synchrony; The blue represents the inhibitory which shows regular spiking, and exitatory neurons a synchronized spiking behaviour </div> <p>So there we have it! A naive but direct look at synchronous spiking behaviour in the brain. Ofcourse, the code I have documented here has a lot issues, which includes stability problems and extremely long computation time for larger number of neurons. Hence, this is not at all an efficient way of coding it up. A cleaner implementation of this can be done by the aforementioned <code class="language-plaintext highlighter-rouge">NEST</code> of <code class="language-plaintext highlighter-rouge">Brian2</code> package.</p> <p>Project tile image credits: <a href="https://commons.wikimedia.org/wiki/File:Journal.pone.0082873.g001.png" rel="external nofollow noopener" target="_blank">Bumhee Park, Dae-Shik Kim, Hae-Jeong Park</a>, <a href="https://creativecommons.org/licenses/by-sa/4.0" rel="external nofollow noopener" target="_blank">CC BY-SA 4.0</a>, via Wikimedia Commons</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2024 Hari prasad SV. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?601a2d3465e2a52bec38b600518d5f70"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about-me",title:"About me",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-publications",title:"Publications",description:"A list of my publications",section:"Navigation",handler:()=>{window.location.href="/publications/"}},{id:"nav-projects",title:"Projects",description:"Feel free to browse through some of my projects. I am still in the process of formatting and adding detailed versions of some of them!",section:"Navigation",handler:()=>{window.location.href="/projects/"}},{id:"nav-talks",title:"Talks",description:"These are some of the presentations I gave as part of course work and otherwise.",section:"Navigation",handler:()=>{window.location.href="/talks/"}},{id:"nav-git",title:"Git",description:"You can find my details of my github profile @Cup-cake-lover here!.",section:"Navigation",handler:()=>{window.location.href="/repositories/"}},{id:"nav-resume",title:"Resume",description:"Here you can find my resume, a detailed pdf version is also available on the link.",section:"Navigation",handler:()=>{window.location.href="/resume/"}},{id:"post-google-gemini-updates-flash-1-5-gemma-2-and-project-astra",title:'Google Gemini updates: Flash 1.5, Gemma 2 and Project Astra <svg width="1.2rem" height="1.2rem" top=".5rem" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg>',description:"We\u2019re sharing updates across our Gemini family of models and a glimpse of Project Astra, our vision for the future of AI assistants.",section:"Posts",handler:()=>{window.open("https://blog.google/technology/ai/google-gemini-update-flash-ai-assistant-io-2024/","_blank")}},{id:"post-displaying-external-posts-on-your-al-folio-blog",title:'Displaying External Posts on Your al-folio Blog <svg width="1.2rem" height="1.2rem" top=".5rem" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><path d="M17 13.5v6H5v-12h6m3-3h6v6m0-6-9 9" class="icon_svg-stroke" stroke="#999" stroke-width="1.5" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg>',description:"",section:"Posts",handler:()=>{window.open("https://medium.com/@al-folio/displaying-external-posts-on-your-al-folio-blog-b60a1d241a0a?source=rss-17feae71c3c4------2","_blank")}},{id:"news-i-started-my-master-s-program-at-the-university-of-cologne",title:"I started my master\u2019s program at the University of Cologne.",description:"",section:"News"},{id:"news-started-my-internship-position-at-forschungzentrum-j\xfclich-j\xfclich-germany",title:"Started my internship position at Forschungzentrum-J\xfclich, J\xfclich, Germany.",description:"",section:"News"},{id:"news-ended-my-internship-position-at-forschungzentrum-j\xfclich-j\xfclich-germany",title:"Ended my internship position at Forschungzentrum-J\xfclich, J\xfclich, Germany.",description:"",section:"News"},{id:"projects-neural-synchrony",title:"Neural synchrony.",description:"Simulating synchrony in brain --&gt; The hard way!",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"projects-trees-are-shy",title:"Trees are shy.",description:"Simulating crown/canopy shyness in trees!",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-learning-from-the-ising-model",title:"Learning from the Ising model!",description:"Boltzmann machine learning!",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-epilepsy-detection-using-non-linear-feature-analysis",title:"Epilepsy Detection Using Non-Linear Feature Analysis",description:"A baseline setup",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"socials-email",title:"Send email",section:"Socials",handler:()=>{window.open("mailto:%68%70%76%61%72%69%79%61%72@%67%6D%61%69%6C.%63%6F%6D","_blank")}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=qc6CJjYAAAAJ","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>